### Requirements
- Installed python3.6-dev
- Installed python3.6-venv
- Installed python3-pip
- User added to dialup group
- Configured AWS cloud


### To develop in PyCharm:
1. Create and activate virtual environment with Python 3.6 using PyCharm GUI
or do it manually.
````bash
cd Micropython
virtualenv venv
pip3 install -r requirements.txt
````

2. Open the project MicroPython with PyCharm and mark *src* and *ulib_mocks* directory as Sources Root in Pycharm.

### AWS and terraform 
Make sure that your AWS cloud is configured. For more information please go to 
ReadMe in "terraform" directory [here](../terraform/README.md).

If you already have configured AWS infrastructure, make sure that:
- terraform binaries (https://www.terraform.io/downloads.html) are in ".terraform" directory.
- you have configured ssh connections with AWS (aws configure)

### Basic Setup of the ESP32
To set up a new board or flash the old one. 
Make sure that your AWS cloud is configured, and your computer has AWS credentials.

#### Creating virtual environment 
If you already have made virtual environment, you can skip this step.
```bash
cd Micropython
python3 -m venv venv
```

#### Activating virtual environment
This step is platform dependent
###### Windows
```bash
venv/Scripts/activate.bat
```

###### Linux/ Mac OS
```bash
source venv/bin/activate
```

#### Install requirements
```bash
pip3 install -r requirements.txt
```

#### Flashing the board
Make sure that your board is connected to computer. Check the port number.

```bash
source venv/bin/activate
python3 scripts/upload_all.py -p <port>
```

After flashing the board please reset it using button EN button.


### Configuring board network 
Connect to the WiFi network created by a board. Network SSID will be:
```
WizzDev_IoT_<board_id>
```
For example:
```
Wizzdev_IoT_8caab5b8c18c
```
Network is open, so password will not be necessary. After successfull connection,
please open your web browser and type in the Address Bar:
```
http://192.168.4.1/web_pages/setup.html
```
Next, type your WiFi network credentials into SSID and Password fields and press
"Submit" button. Remember that this network should have an internet connection. 
Otherwise, data will not be sent to the AWS.

### Logs from the device
If you want to see logs from working device you should access serial port 
communication with board. We recommend you programs listed below.

#### Linux
On Linux you can use picocom:
```bash
sudo apt-get install picocom
picocom port_name --baud 115200
```

#### Windows 
On Windows you can use PuTTy _(https://www.putty.org/)_

#### Mac 
On Linux you can also use picocom

### Checking measurement
There are two ways to check measurements sent from the board. First is using AWS IoT core service,
second is visualization page prepared by WizzDev.

#### Using IoT Core
Log in to your AWS account. Go to 'IoT Core' service. Next, choose "Test" and into "Subscription topic" 
type:
```
topic/data
```
Finally, click "Subscribe to topic". After some time you should see dataframes send by ESP32 board.

#### Visualization page
Visualization page url is generated by AWS during infrastructure build. So URL is connected with your
AWS account. You can find this URL in places listed below:
- in file MicroPython/src/aws_config.json as **visualization_url**


